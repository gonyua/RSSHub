# Rebang.Today 风格站点（基于本仓库数据）需求与实施计划（讨论稿）

> 目标：做一个尽量“页面结构 / 页面样式 / 页面交互”都接近 `https://rebang.today/` 的站点，但数据来源改为本仓库（RSSHub）可提供的数据。
>
> 说明：本文只做需求澄清与实施计划，不开始正式实现；等你确认范围与技术路线后再动手。

## 0. 已确认（来自本次沟通）

- 入口：新增 `/rebang`
- 登录/订阅：MVP 不做
- “飙升榜”：MVP 先做“轮换榜/抽样榜”
- MVP 节点范围：我先自选一组可用节点（后续可迭代补齐）
- 待确认：数据来源采用 3.1 的解释 A/B/C 中哪一种（建议默认采用 A）
- 待确认：技术路线采用“方案 1（渐进增强）”还是“方案 2（融合前端项目）”

## 0.1 当前实现进度（持续更新）

- 已完成：`/rebang`、`/rebang/tech`、`/rebang/dev`、`/rebang/ent`、`/rebang/community`、`/rebang/fin`、`/rebang/setting`、`/rebang/following`
- 已完成：明/暗/跟随系统、本地设置（打开方式/列表展示/选项卡默认/默认菜单/屏蔽词）
- 已完成：`/api/rebang/menu`、`/api/rebang/items`、`/api/rebang/rising`
- 已完成：侧栏“轮换榜/抽样榜”（换一换）、当前列表搜索
- 已对齐 rebang.today 的菜单结构（含各节点子 Tab），并在缺失/需配置的节点上做禁用与原因提示
- 已新增：来源覆盖审计清单 `rebang-sources-audit.md`
- 已修正：Rebang 内部拉取 feed 时统一传 `sorted=false`，避免 RSSHub 默认按 `pubDate` 重排导致“热度榜顺序”被打乱
- 已新增：腾讯新闻热榜路由 `/tencent/news/hot-ranking`（用于对齐 `rebang.today/home?tab=tencent-news` 的“热度排序”）

## 1. 竞品观察结论（基于 MCP）

### 1.1 信息架构 / 路由

- 顶部一级菜单（对应 URL Path）：
    - `综合`：`/`（页面标题“今日热榜 - 全站热榜”）
    - `科技`：`/tech`
    - `娱乐`：`/ent`
    - `社区`：`/community`
    - `财经`：`/fin`
    - `开发`：`/dev`
    - `订阅`：`/following`（未登录提示）
    - `设置`：`/setting`
- 页脚：反馈、社群、赞助/会员/广告、安装到桌面（PWA）、备案信息等。

### 1.2 页面布局（桌面端）

- 顶部固定导航：站点 Logo + 一级菜单 +（图标按钮）主题切换、设置 + 登录按钮。
- 主体为“左右分栏”：
    - 左侧主内容：节点（站点来源）选择条 + 榜单时间维度 Tab + 榜单列表（卡片/列表项）。
    - 右侧侧栏：广告卡片、搜索输入框、`全站飙升榜`（带“换一换”刷新）。

### 1.3 节点（站点来源）与榜单维度

Rebang 使用 `menu_tabs` 配置来驱动 UI（通过其 API 观察到的结构，以下为**菜单结构摘要**）：

#### 综合（/home）

- 全站：今日 / 本周 / 本月
- 知乎
- 微博：热搜 / 文娱
- IT之家：日榜 / 最新 / 周榜 / 月榜
- 虎扑：步行街 / NBA / 游戏 / 数码 / 影视娱乐 / 国际足球
- 腾讯新闻
- 豆瓣社区：精选讨论 / 热门话题 / 发现小组
- 虎嗅：热文 / 最新 / 号外
- 少数派：推荐 / 最热
- 澎湃新闻：热榜
- 小红书：热点
- 36氪：热榜 / 最新 / 快讯
- 今日头条、爱范儿…… -（省略若干，综合共 36 个节点）

#### 科技（/tech）

- IT之家：日榜 / 最新 / 周榜 / 月榜
- 少数派：推荐 / 最热
- 爱范儿
- 蓝点网：文章 / 下载
- 36氪：热榜 / 最新 / 快讯
- 吾爱破解：今日 / 本周 / 本月
- 虎嗅：热文 / 最新 / 号外
- 果壳

#### 娱乐（/ent）、社区（/community）、财经（/fin）、开发（/dev）

- 结构类似：一级菜单选择分类 → 顶部节点条选择来源（有些来源带二级子 Tab）→ 列表展示对应榜单。

### 1.4 列表与交互细节（观察到的可见行为）

- 支持明暗主题（暗色背景接近 `#0d1117`，列表卡背景接近 `#161b22`，hover/强调色为红色系）。
- 列表展示模式可配置（设置页）：`完整 / 无图 / 精简`。
- 链接打开方式可配置：`新标签页 / 当前标签页`。
- 节点条支持“展开/收起”切换（视觉上切换为多行展示/单行滚动）。
- 侧栏 `全站飙升榜` 支持“换一换”（切换一组条目）。
- 设置页（/setting）包含：主题、打开链接方式、列表展示、选项卡默认（折叠/展开）、默认菜单、自定义屏蔽词（本地保存，登录后云端）。
- 订阅页（/following）需要登录，未登录只提示并提供“去登录”按钮。

---

## 2. 我们要做的“克隆”范围（建议拆成 MVP → 增量）

为了尽量贴近但可控，建议按两阶段推进：

### 2.1 MVP（第一版，优先做“像”）

1. **页面与路由**
    - `/<首页>`：综合（默认节点：全站）
    - `/tech` `/ent` `/community` `/fin` `/dev`：分类页
    - `/setting`：设置页（本地存储即可）
    - `/following`：先做“未登录占位页”（不实现登录）
2. **通用交互**
    - 明/暗/跟随系统主题
    - 节点条：横向滚动 + 展开/收起
    - 榜单维度 Tab（每个节点按其能力决定展示哪些维度）
    - 列表展示：完整 / 无图 / 精简
    - 屏蔽词：对标题（可选：摘要）做过滤（客户端过滤即可）
3. **数据**
    - 先接入一小部分“确定可用、无需复杂配置”的 RSSHub 路由作为节点数据源（见第 3 节）。
    - 对不同源的数据做统一结构化：标题、链接、发布时间（如有）、摘要（从 `description` 提取）、缩略图（从 `description` 中提取第一张图）。

### 2.2 第二阶段（做“全”与“真”）

- 补齐更多节点（对齐 Rebang 的菜单数量与结构）。
- 实现右侧“飙升榜”的真实性（需要“同比/环比”或“历史快照”计算）。
- 订阅/登录（可选）：
    - 最小实现：基于 Cookie/Token 的简单账号体系或外部 OAuth（这会引入存储与安全要求，需要你确认）。
- PWA “安装到桌面” 完整支持（manifest、icons、service worker）。
- 站点级搜索（跨节点）与高级筛选。

---

## 3. 数据来源（“来自当前项目的数据”如何落地）

### 3.1 需要你确认的关键点

你说“内容来自于当前项目的数据”，这里有三种解释，影响实现方式：

1. **解释 A（推荐）**：页面展示的数据来自“RSSHub 本身已实现的各路由输出”（即我们用 RSSHub 路由去抓取各站热榜/热帖/热搜，然后在页面展示）。
2. **解释 B**：页面展示来自仓库内已有的某份数据集（例如 `assets/build/*.json` 之类）——目前我看到主要是路由元数据，不是热榜内容；若你有额外数据文件，需要你指出路径与格式。
3. **解释 C**：页面展示来自你在本项目外部生成/存储的数据（数据库/接口）——这会引入额外依赖与部署要求。

请你选一个（或说明你的真实需求）。

### 3.2 如果采用解释 A：节点到 RSSHub 路由的映射（草案）

为了“像 Rebang”，我们会做一个**配置表**：`分类 -> 节点 -> 子 Tab -> RSSHub 路由 path`。先从易用源开始，逐步补齐。

示例（已在仓库中确认存在的路由，仅举例，不代表最终菜单）：

- 知乎（综合）
    - 节点：知乎
    - RSSHub：`/zhihu/hot`
- IT之家（科技/综合）
    - 日榜：`/ithome/ranking/24h`
    - 周榜：`/ithome/ranking/7days`
    - 月榜：`/ithome/ranking/monthly`
    - 最新（待定：可用 `/ithome/:caty` 体系或另选更贴近“最新”的路由）
- 虎扑（综合/娱乐/社区）
    - 热帖：`/hupu/all/:id?`（例如 `topic-daily` 等）

注意：有些热门源在 RSSHub 中可能需要额外配置（Cookie/Token）或会触发反爬；我们需要在菜单上标记“需配置/不可用”，并在 UI 中做清晰提示。

---

## 4. 技术方案建议（尽量少引入新框架，贴合现有工程）

本仓库已有基于 Hono + JSX 的服务端渲染页面（例如 `lib/views/index.tsx`），并且通过 `https://cdn.tailwindcss.com` 使用 Tailwind。

为了快速复刻 Rebang 的交互与样式，建议：

### 方案 1（推荐）：服务端页面 + 少量前端 JS（渐进增强）

- 新增页面：`/rebang`
- 页面骨架用 `lib/views/*.tsx` 输出（Tailwind 负责样式）
- 前端交互用原生 JS/少量模块：
    - 读取/写入 localStorage（主题、展示模式、屏蔽词等）
    - fetch 本服务的 JSON API 获取榜单数据
    - 渲染列表（DOM patch）
- 服务端新增 JSON API：
    - `GET /api/rebang/menu`：返回菜单与节点配置（我们自己的配置，不依赖 rebang API）
    - `GET /api/rebang/items?menu=home&tab=zhihu&sub=today`：返回统一结构的条目列表
- 优点：不引入 React/Vite；部署与现有 RSSHub 一致；改动集中、可控。

### 方案 2：单独前端应用（Vite/React 等）+ 后端 API

- 优点：复杂交互更容易，组件化更强
- 缺点：需要引入构建链、静态资源产物管理、CI/部署调整

我倾向先做方案 1，等功能稳定再评估是否升级到方案 2。

### 4.1 “融合前端项目”是否合适？（对你的问题的回答）

合适，但我建议先按**方案 1**做出“像 Rebang”的 MVP，再决定是否上前端工程化：

- 如果目标是**尽快上线 + 少改现有工程**：优先方案 1（SSR + 少量 JS），交互量在可控范围内也能做得很像。
- 如果后续要做**大量客户端交互**（登录、订阅、多列表筛选、拖拽排序、复杂缓存、离线/PWA、全站搜索等）：可以升级到方案 2，把 UI 独立成一个前端应用。

升级到方案 2 时建议的落地方式（不改动核心 RSSHub 运行方式）：

- 前端工程放到仓库子目录（例如 `apps/rebang-web`）
- 构建产物输出到 `public/rebang/`
- Hono 侧用静态资源中间件把 `/rebang` 路由指向前端入口（以及 `/rebang/*` 走前端路由）

---

## 5. 实施计划（建议按“可交付里程碑”推进）

### Milestone 0：需求确认（你确认后才开始写实现）

1. 确认“数据来源解释 A/B/C”（若不特别说明，我默认采用解释 A）
2. 确认技术路线：方案 1（渐进增强）还是方案 2（融合前端项目）
3. 确认 MVP 节点范围：我先做 6~10 个节点（见下方建议），可接受吗？

### Milestone 1：页面骨架与主题/设置

- 完成页面布局（顶栏/主体/侧栏/页脚）与响应式（桌面/移动）
- 完成主题切换（明/暗/跟随系统）与本地持久化
- 完成设置页（/setting）与本地持久化

### Milestone 2：菜单/节点/Tab 与列表渲染

- 实现菜单配置与节点条（展开/收起）
- 实现维度 Tab 切换
- 实现列表三种展示模式（完整/无图/精简）

### Milestone 3：接入 RSSHub 数据（先少量节点）

- 为每个节点实现数据适配：RSS → 统一 JSON
- 处理常见字段：
    - `title`、`link`、`pubDate`、`description/summary`、`image`
- 增加缓存（避免频繁抓取上游站点）

### Milestone 4：侧栏增强（飙升榜/搜索）

- 先做“简版飙升榜”（例如从多个源抽样/轮换）
- 再做“真实飙升榜”（需要历史快照与对比算法）

---

## 6. MVP 节点范围（我先自选，后续可调整）

优先选择“无需额外配置、无需 Puppeteer”的路由，避免一上来就被 Cookie/反爬卡住。建议第一版先接入：

- 综合
    - 知乎热榜：`/zhihu/hot`
    - IT之家 24h：`/ithome/ranking/24h`
    - 虎扑热帖：`/hupu/all/topic-daily`
- 科技
    - IT之家 7days：`/ithome/ranking/7days`
    - IT之家 monthly：`/ithome/ranking/monthly`
- 开发
    - 掘金 本周：`/juejin/trending/all/weekly`
    - 掘金 本月：`/juejin/trending/all/monthly`

“全站”节点：先做聚合视图（从上述多个源抽样合并）以模拟 Rebang 的“全站”体验。

## 7. 待你最终确认（确认后我开始正式实现）

1. 数据来源：我按 **解释 A** 做，可以吗？（即页面展示来自 RSSHub 已实现的路由输出）
2. 技术路线：我按 **方案 1（渐进增强）** 做，可以吗？（后续再评估是否引入 Vite/React）
3. MVP 节点范围：按第 6 节这组先做，可以吗？
